<!-- Set variable for csv -->
{% set csv_egypt_annex = "Pest,Establishment,Impact,Establishment * Impact,Establishment,Impact,Establishment * Impact
Aphis spiraecola,4,2,8,4,2,8
Bagrada hilaris,3,3,9,3,3,9
Beet curly top virus,5,4,20,5,4,20
Beet necrotic yellow vein benyvirus,,3,0,,3,0
Chrysodeixis chalcites,0,3,0,0,3,0
Globodera rostochiensis Non-European Strains,5,4,20,5,4,20
Helicotylenchus dihystera,5,3,15,5,3,15
Helicoverpa armigera,5,2,10,5,2,10
Leveillula taurica,,3,0,,3,0
Liriomyza sativae,5,5,25,3,3,9
Liriomyza trifolii,5,3,15,3,3,9
Meloidogyne arenaria,5,3,15,5,3,15
Meloidogyne hapla,,,0,,,0
Meloidogyne javanica,5,3,15,5,3,15
Naupactus cervinus,5,2,10,5,2,10
Ostrinia nubilalis,,3,0,,3,0
Paratrichodorus minor,5,2,10,4,2,8
Phenacoccus parvus,3,2,6,3,2,6
Phenacoccus solani,5,3,15,4,3,12
Phenacoccus solenopsis,5,3,15,4,3,12
Phytophthora citrophthora,,,0,,,0
Phytophthora infestans,,5,0,,5,0
Potato spindle tuber viroid,5,3,15,3,3,9
Potato virus M (non-European strains),5,3,15,5,3,15
Potato virus S (non-European strains),5,3,15,5,3,15
Potato virus X (non-European strains),5,2,10,5,2,10
Potato virus Y (non-European strains),5,3,15,5,3,15
Pratylenchus brachyurus,2,1,2,2,1,2
Pratylenchus scribneri,4,2,8,4,2,8
Ralstonia solanacearum,,5,0,,3,0
Rhopalosiphum rufiabdominale,3,3,9,3,3,9
Spodoptera littoralis,5,3,15,4,3,12
Spongospora subterranea,,,0,,,0
Tomato chlorosis virus,5,3,15,4,3,12
Tomato ringspot virus,,2,0,,2,0
Tomato spotted wilt virus,,3,0,,3,0
Tomato yellow leaf curl virus,5,4,20,2,4,8
Trialeurodes ricini,4,3,12,4,3,12
Tuta absoluta,0,3,0,0,3,0" %}





{{ csv_egypt_tuber_bulbstubers | csvToArray | log }}


{{ data | log }}




{% set annex_selected = "" %}

{% if data["country"] == "Egypt" and data["format"] == "Bulbs or tubers" and data["host"] == "Solanum tuberosum" %}
  {% set csv_selected = csv_egypt_tuber_bulbstubers %}
{% endif %}

{% if data["country"] == "South Africa" and data["format"] == "Fruits or vegetables" and data["host"] == "Vitis vinifera ssp. vinifera" %}
  {% set csv_selected = csv_southAfrica_grapes_fruitAndVegetables %}
{% endif %}

{% if data["country"] == "Norway" and data["format"] == "Cut flowers or branches" and data["host"] == "Abies" %}
  {% set csv_selected = csv_norway_spruce %}
{% endif %}

{% if data["country"] == "New Zealand" and data["format"] == "Plants for planting (except seeds, bulbs and tubers)" and data["host"] == "Rosa" %}
  {% set csv_selected = csv_newZealand_roses %}
{% endif %}


{# Fallback #}
{% if csv_selected == "" %}
  {# {% set csv_selected = csv_southAfrica_grapes_fruitAndVegetables %} #}
{% endif %}

{% set source_array_data = csv_selected | csvToArray | removeFirstItemFromArray %}
{% set array_data = [] %}

{% for row in source_array_data %}
  {% set new_row = [] %}
  {% for column in row%}
    {% if loop.index0 == 0 %}
      {% set cell %}
        <a href='{{ column | kebabCase }}'>{{ column }}</a>
      {% endset %}
    {# can add other columns here loop.loopindex4 for example #}
    
    {% else %}
      {% set cell = column %}
    {% endif%}
    {# can add other columns here #}
    
    {% set new_row = new_row | push(cell) %}
  {% endfor %}
  {% set array_data = array_data | push(new_row) %}
{% endfor%}


{% set table_data = array_data | arrayToGovukTable%}




{{ govukTable({
  classes: "govuk-!-margin-top-6",
  firstCellIsHeader: false,
  head: [
        {  
          text: "Pest"
        },
        {
          text: "Establishment"
        },
        {
          text: "Impact"
        },
        {
          text: "Establishment * Impact"
        },
        {
          text: "Establishment"
        },
        {
          text: "Impact"
        },
        {
          text: "Establishment * Impact"
        },
        {
          text: "Another col"
        }
        ],
  rows: table_data
}) }}


{# {% set fruit = ["Apples", "Oranges", "Pears", "Bananas"] %}
<p class="govuk-body">
  {{ fruit | join(" ") }}  
<p> #}